# Chrome Safe Area Plugin - æ„å»ºç³»ç»Ÿè§„èŒƒ

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®å·²å‡çº§åˆ°ä½¿ç”¨ **Vite** ä½œä¸ºä¸»è¦æ„å»ºå·¥å…·ï¼Œæ›¿æ¢äº†ä¹‹å‰çš„è‡ªå®šä¹‰æ„å»ºè„šæœ¬ï¼Œæä¾›æ›´å¯é å’Œè§„èŒƒçš„æ„å»ºæµç¨‹ã€‚

## ğŸ”§ æ„å»ºç³»ç»Ÿæ¶æ„

### ä¸»è¦å·¥å…·
- **Vite 5.x** - ç°ä»£å‰ç«¯æ„å»ºå·¥å…·
- **TypeScript 5.x** - ç±»å‹æ£€æŸ¥å’Œç¼–è¯‘
- **ESLint** - ä»£ç è´¨é‡æ£€æŸ¥
- **npm** - åŒ…ç®¡ç†å™¨

### æ„å»ºé…ç½®æ–‡ä»¶
- `vite.config.ts` - Vite ä¸»é…ç½®
- `tsconfig.json` - TypeScript é…ç½®
- `package.json` - æ„å»ºè„šæœ¬å®šä¹‰

## ğŸš€ æ„å»ºå‘½ä»¤

### å¼€å‘æ¨¡å¼
```bash
# æ„å»ºå¹¶å¯åŠ¨ç›‘å¬æ¨¡å¼
npm run dev

# ä»…å¯åŠ¨ç›‘å¬æ¨¡å¼
npm run dev:watch
```

### ç”Ÿäº§æ„å»º
```bash
# å®Œæ•´æ„å»ºï¼ˆç±»å‹æ£€æŸ¥ + æ„å»ºï¼‰
npm run build

# æ„å»ºå¹¶æ‰“åŒ…æˆ zipï¼ˆç”¨äº Chrome Web Storeï¼‰
npm run build:zip
npm run build:package  # åŒä¸Šï¼Œåˆ«å

# ä»…æ„å»ºï¼ˆè·³è¿‡ç±»å‹æ£€æŸ¥ï¼‰
vite build
```

### è´¨é‡æ£€æŸ¥
```bash
# TypeScript ç±»å‹æ£€æŸ¥
npm run type-check

# ESLint ä»£ç æ£€æŸ¥
npm run lint

# ä¿®å¤ ESLint é”™è¯¯
npm run lint:fix

# è¿è¡Œå•å…ƒæµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•ï¼ˆä¸€æ¬¡æ€§ï¼‰
npm run test:run

# æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# å®Œæ•´éªŒè¯ï¼ˆç±»å‹ + ä»£ç è´¨é‡ + æµ‹è¯•ï¼‰
npm run validate
```

### å·¥å…·å‘½ä»¤
```bash
# æ¸…ç†æ„å»ºç›®å½•
npm run clean

# ä»…æ‰“åŒ…ç°æœ‰æ„å»ºï¼ˆæ— éœ€é‡æ–°æ„å»ºï¼‰
npm run package

# æ¸…ç†æ‰€æœ‰ ZIP åŒ…
npm run clean-packages

# ç”Ÿæˆå›¾æ ‡
npm run generate-icons

# æ¸…ç†å›¾æ ‡æ–‡ä»¶
npm run clean-icons
```

## ğŸ“ æ„å»ºè¾“å‡º

æ„å»ºåçš„æ–‡ä»¶ä½äº `./dist` ç›®å½•ï¼š

```
dist/
â”œâ”€â”€ background.js      # Service Worker
â”œâ”€â”€ content.js         # Content Script
â”œâ”€â”€ popup.js          # Popup è„šæœ¬
â”œâ”€â”€ devices.js        # è®¾å¤‡æ•°æ®
â”œâ”€â”€ phone-*.js        # å¯é€‰ç»„ä»¶
â”œâ”€â”€ manifest.json     # æ‰©å±•æ¸…å•
â”œâ”€â”€ popup.html        # Popup HTML
â”œâ”€â”€ popup.css         # Popup æ ·å¼
â”œâ”€â”€ icons/            # å›¾æ ‡èµ„æº
â””â”€â”€ *.js.map         # Source Maps
```

## ğŸ“¦ æ‰©å±•æ‰“åŒ…

### è‡ªåŠ¨æ‰“åŒ…
ä½¿ç”¨ `npm run build:zip` ä¼šåœ¨æ„å»ºå®Œæˆåè‡ªåŠ¨åˆ›å»º ZIP åŒ…ï¼š

```bash
npm run build:zip
# ç”Ÿæˆæ–‡ä»¶: packages/chrome-safe-area-plugin-v1.0.0-20240722T123456.zip
```

### æ–‡ä»¶ç»„ç»‡ç»“æ„
æ‰€æœ‰ ZIP åŒ…éƒ½å­˜æ”¾åœ¨ `packages/` ç›®å½•ä¸‹ï¼š

```
packages/
â”œâ”€â”€ chrome-safe-area-plugin-v1.0.0-20240722T123456.zip
â”œâ”€â”€ chrome-safe-area-plugin-v1.0.1-20240723T091234.zip
â””â”€â”€ ...
```

### æ–‡ä»¶å‘½åè§„åˆ™
ZIP æ–‡ä»¶åæ ¼å¼ï¼š`packages/chrome-safe-area-plugin-v{version}-{timestamp}.zip`
- `version`: ä» manifest.json è¯»å–
- `timestamp`: æ„å»ºæ—¶é—´æˆ³ï¼ˆISO æ ¼å¼ï¼Œç§»é™¤ç‰¹æ®Šå­—ç¬¦ï¼‰
- `packages/`: ä¸“ç”¨ç›®å½•ï¼Œå·²æ·»åŠ åˆ° .gitignore

### æ‰‹åŠ¨æ‰“åŒ…
åŸºäºç°æœ‰çš„ `dist` ç›®å½•åˆ›å»º ZIP åŒ…ï¼š

```bash
npm run package
```

### æ‰“åŒ…ç‰¹æ€§
- **æœ€å¤§å‹ç¼©**: ä½¿ç”¨ zlib level 9 å‹ç¼©
- **å®Œæ•´æ€§æ£€æŸ¥**: éªŒè¯ manifest.json å’Œå¿…éœ€æ–‡ä»¶
- **æ–‡ä»¶å¤§å°æ˜¾ç¤º**: æ˜¾ç¤ºå‹ç¼©åçš„æ–‡ä»¶å¤§å°
- **ç‰ˆæœ¬æ§åˆ¶**: è‡ªåŠ¨åŒ…å«ç‰ˆæœ¬å·å’Œæ—¶é—´æˆ³
- **é›†ä¸­ç®¡ç†**: æ‰€æœ‰åŒ…å­˜æ”¾åœ¨ `packages/` ç›®å½•
- **Git å¿½ç•¥**: æ„å»ºäº§ç‰©ä¸ä¼šæ„å¤–æäº¤åˆ°ç‰ˆæœ¬åº“

## ğŸ¯ æ„å»ºç‰¹æ€§

### âœ… ä¼˜åŠ¿
1. **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript æ”¯æŒ
2. **ç°ä»£åŒ–** - ä½¿ç”¨ ES2020 æ ‡å‡†
3. **è°ƒè¯•å‹å¥½** - ç”Ÿæˆ Source Maps
4. **å¿«é€Ÿæ„å»º** - Vite çš„é«˜æ€§èƒ½æ„å»º
5. **è‡ªåŠ¨åŒ–** - é›†æˆç±»å‹æ£€æŸ¥ã€ä»£ç è´¨é‡æ£€æŸ¥å’Œå•å…ƒæµ‹è¯•
6. **æ‰©å±•éªŒè¯** - è‡ªåŠ¨éªŒè¯ Chrome æ‰©å±•ç»“æ„
7. **æµ‹è¯•è¦†ç›–** - å®Œæ•´çš„å•å…ƒæµ‹è¯•æ¡†æ¶å’Œæ¨¡æ‹Ÿç¯å¢ƒ
8. **è‡ªåŠ¨æ‰“åŒ…** - æ”¯æŒè‡ªåŠ¨ç”Ÿæˆ Chrome Web Store å‘å¸ƒåŒ…

### ğŸ”§ å…³é”®é…ç½®

#### TypeScript é…ç½®
- ç›®æ ‡: ES2020
- æ¨¡å—è§£æ: bundler æ¨¡å¼
- ä¸¥æ ¼ç±»å‹æ£€æŸ¥: å¯ç”¨
- è·¯å¾„åˆ«å: `@/*` â†’ `src/*`

#### Vite é…ç½®
- è¾“å‡ºæ ¼å¼: ES Modules
- å¤šå…¥å£ç‚¹: æ”¯æŒæ‰€æœ‰è„šæœ¬æ–‡ä»¶  
- å¤–éƒ¨ä¾èµ–: Chrome APIs
- é™æ€èµ„æº: è‡ªåŠ¨å¤åˆ¶å’ŒéªŒè¯
- å…¨å±€å˜é‡: è‡ªåŠ¨æš´éœ² `window.DEVICES`
- Chrome æ‰©å±•æ’ä»¶: å¤„ç†æ¨¡å—å…¼å®¹æ€§
- è‡ªåŠ¨æ‰“åŒ…: æ„å»ºå®Œæˆåç”Ÿæˆ ZIP å‘å¸ƒåŒ…

## ğŸ”„ è¿ç§»è¯´æ˜

### ä»æ—§æ„å»ºç³»ç»Ÿè¿ç§»
- âœ… ä¿ç•™åŸæœ‰çš„ `scripts/build.cjs`ï¼ˆä½œä¸º `build:legacy`ï¼‰
- âœ… æ–°å¢ Vite æ„å»ºæµç¨‹
- âœ… ç»Ÿä¸€ä½¿ç”¨ `npm run build`
- âœ… æ”¹è¿›çš„é”™è¯¯å¤„ç†å’ŒéªŒè¯

### å…¼å®¹æ€§
- Node.js 16+ 
- Chrome Extension Manifest V3
- ç°ä»£æµè§ˆå™¨ ES2020 æ”¯æŒ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ„å»ºå¤±è´¥ - ç±»å‹é”™è¯¯**
   ```bash
   npm run type-check  # å•ç‹¬æ£€æŸ¥ç±»å‹
   ```

2. **æ„å»ºå¤±è´¥ - ESLint é”™è¯¯**
   ```bash
   npm run lint:fix    # è‡ªåŠ¨ä¿®å¤
   ```

3. **éœ€è¦ä½¿ç”¨æ—§æ„å»ºç³»ç»Ÿ**
   ```bash
   npm run build:legacy  # ä½¿ç”¨åŸæœ‰æ„å»ºè„šæœ¬
   ```

### è°ƒè¯•æ¨¡å¼
- Source Maps å·²å¯ç”¨ï¼Œå¯åœ¨ Chrome DevTools ä¸­è°ƒè¯•åŸå§‹ TypeScript ä»£ç 
- æœªå‹ç¼©ä»£ç ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥

## ğŸ“Š æ„å»ºæ€§èƒ½

- âš¡ åˆæ¬¡æ„å»º: ~100ms
- ğŸ”„ å¢é‡æ„å»º: ~50ms
- ğŸ“¦ è¾“å‡ºå¤§å°: ~40KB ï¼ˆæœªå‹ç¼©ï¼‰
- ğŸ—ºï¸ Source Maps: åŒ…å«

## ğŸ”® æœªæ¥æ”¹è¿›

- [ ] æ·»åŠ å•å…ƒæµ‹è¯•é›†æˆ
- [ ] é›†æˆä»£ç è¦†ç›–ç‡æŠ¥å‘Š
- [ ] è‡ªåŠ¨åŒ– Chrome å•†åº—æ‰“åŒ…
- [ ] å¤šç¯å¢ƒé…ç½®æ”¯æŒ

---

*æœ€åæ›´æ–°: 2024å¹´7æœˆ* 